# 产品文档更新：26天周期及历史记录功能

## 1. 产品概述

本产品为一款智能日历系统，在原有功能基础上增加了周期性提醒及详细的历史记录功能。主要功能包括：

- 指定开始日期及具体小时：用户可选定一个开始日期和具体小时，系统根据该时间作为日历有效记录的起点。
- 跳过指定时段：系统自动根据默认规则跳过从开始小时到半天后（或其他可配置时长）的时间段，并以颜色高亮显示。
- 多视图展示：支持单月或多月视图展示，便于用户查看日历整体规划。
- 26天周期提醒：当有效（非跳过）的日期累计达到 26 天时，系统触发提醒，同时记录本周期结束时间，并自动记录下一周期的开始时间，重新计数 26 天。
- 历史记录功能：系统保存每一轮 26 天周期的详细记录，包括周期开始、结束的具体日期及小时，以及周期内跳过的时段详情，方便后续查询、统计和导出。

## 2. 主要功能描述与需求

### 2.1 日历时段设置与跳过规则

- **开始时间设定**  
用户通过日期和时间选择控件设定一个起始时间（例如 2025-04-01 08:00）。

- **跳过时段计算**  
默认规则：
  - 从用户设定的开始小时起，到当天半天后（或其他预设时长）的时段将被标记为"跳过"，并以预设颜色高亮显示；
  - 用户编辑跳过的时间段。

### 2.2 26天周期提醒与新周期记录

- **26天有效记录**  
系统对日历中非跳过时段的"有效日期"进行累计。当累计有效日期达到 26 天后，触发提醒：
  - 弹出提醒窗口，通知用户已达 26 天有效记录；
  - 此时视为当前周期结束。

- **新周期自动启动**  
  - 在提醒触发后，系统自动记录当前周期结束的具体时间（精确到小时）；
  - 同时，记录下一周期的开始时间（通常为结束后当天或次日的某个预设小时），从新周期开始重新累计 26 天有效记录，形成循环。

### 2.3 历史记录功能

- **周期历史记录**  
系统需要保存所有已完成周期的详细信息，包括：
  - 周期编号：可自动生成序号或唯一标识符。
  - 开始时间：记录周期开始的日期及具体小时。
  - 结束时间：记录周期结束时的日期及具体小时（即达到 26 天有效记录时）。
  - 跳过时段信息：记录本周期内各天跳过的时间段（例如每天跳过 08:00~20:00 的时段，或根据规则动态计算的跳过时段）。
  - 有效记录统计：可选项，记录本周期内有效（非跳过）日期的累计情况，便于统计和后续导出报表。

- **历史记录展示**  
  - 前端提供一个历史记录页面或模块，用户可以浏览、筛选及导出每一轮周期的详细记录；
  - 历史记录以列表或图表形式展示，支持按日期、周期编号等条件进行查询。

## 3. 技术架构设计

### 3.1 前端设计

- **主要页面**
  - 日历页面：包含开始日期/小时选择控件、日历展示区（支持单月或多月视图）以及跳过时段的颜色高亮展示；
  - 周期提醒与新周期启动：在日历页面中，当有效记录达到 26 天时自动弹窗提醒，并在后台更新状态，显示当前周期结束和新周期开始的标识。

- **历史记录页面**：展示所有周期记录，提供详细的开始、结束时间和跳过时段信息，支持导出和筛选功能。

- **交互流程**
  - 用户设定起始时间后，系统自动计算每天跳过的时段，并在日历上以颜色高亮显示；
  - 日历数据显示时，后台不断累计有效日期，当累计 26 天时触发提醒；
  - 弹窗提醒后，系统自动更新状态，将当前周期标记为已完成，并保存周期详情；
  - 界面立即显示新周期的开始信息，重新计数 26 天有效日期。

- **前端技术栈**
  - 使用 React 或 Vue 构建单页应用（SPA）；
  - 利用现代 CSS 框架（如 Tailwind CSS、Material UI 或 Ant Design）设计美观、响应式的界面；
  - 前端与后端通过 Axios 或 Fetch 进行 API 通信。

### 3.2 后端设计

- **API 接口**  
后端使用 Python（推荐 FastAPI 或 Flask）实现以下接口：
  - 日历数据接口：接收前端请求，根据用户设定的开始时间和跳过规则计算日历数据，并返回标记好的日期信息。
  - 周期记录接口：
    - 接收当前周期完成时的提醒请求，保存当前周期的详细记录（开始时间、结束时间、跳过时段数据等）；
    - 提供查询接口供前端获取历史周期记录。
  - 有效日期统计接口：提供对当前周期有效记录的累计计算逻辑，判断是否达到 26 天，并返回相应状态。

- **数据存储**  
  - 后端可使用轻量级数据库（如 SQLite）存储用户设置、日历数据及周期历史记录；
  - 数据表设计示例：
    - CalendarSettings：存储用户起始时间、跳过规则等配置；
    - CycleRecords：存储周期记录，包括周期编号、开始时间、结束时间、跳过时段 JSON 数据、有效日期累计情况等。

- **部署与扩展**
  - 后端服务与前端部署到 Render 平台，支持 HTTPS 及自动构建；
  - 接口支持跨域请求（CORS 配置）。

## 4. 开发与部署计划

### 4.1 前端开发计划

1. **原型与设计**
   - 使用 Figma、Sketch 等工具设计新版日历页面和历史记录页面原型；
   - 定义周期提醒及新周期启动的用户交互流程。

2. **页面实现**
   - 搭建前端项目，集成日历组件，支持自定义跳过时段颜色显示；
   - 实现周期累计及提醒弹窗效果，确保界面响应及时。
   - 开发历史记录页面，支持详细记录展示、筛选及导出。

3. **联调测试**
   - 与后端 API 对接，测试日历数据计算、周期提醒、历史记录保存与查询功能；
   - 进行多设备、多浏览器测试，保证响应式设计与交互体验。

### 4.2 后端开发计划

1. **接口设计与文档**
   - 使用 OpenAPI/Swagger 编写详细接口文档，明确各 API 参数、返回格式和业务逻辑；
   - 设计数据库表结构（如 CycleRecords 表）。

2. **API 实现**
   - 使用 FastAPI 或 Flask 编写日历数据计算接口、周期记录保存接口及历史记录查询接口；
   - 实现有效日期统计逻辑，判断达到 26 天后自动触发提醒，并记录周期结束及新周期开始。

3. **测试与部署**
   - 编写单元测试和集成测试，验证各接口逻辑正确性；
   - 部署后端服务到 Render，配置环境变量及自动部署流程。

### 4.3 整体联调与验收

- **前后端联调**
  - 确保前端页面与后端 API 数据传输无误，交互流程顺畅；
  - 验证周期提醒、历史记录保存及查询功能是否满足业务需求。

- **上线前验收**
  - 完成最终用户验收测试（UAT），并根据反馈进行最后调整；
  - 完成文档和部署说明，确保运维团队能够顺利维护。

## 5. 部署与后续优化

- **部署方案**
  - 前端：构建完成后，将静态资源部署到 Render 静态站点服务；
  - 后端：将 Python API 服务部署到 Render Web 服务，并配置自动构建与环境变量。

- **后续扩展与优化**
  - 根据用户反馈逐步优化跳过时段规则和周期提醒逻辑；
  - 增加用户自定义配置选项，支持调整周期长度、跳过时段时长及颜色方案；
  - 丰富历史记录数据分析，如生成统计图表、导出 CSV 报表等。

## 6. 总结

本更新版产品文档在原有日历系统功能基础上，新增了 26 天周期提醒功能及详细历史记录功能。系统不仅能自动计算跳过时段并以颜色标识，还能在达到 26 天有效记录后触发提醒、记录本周期结束及下一周期开始时间，并将每个周期的详细信息存档供后续查询和统计。前后端均采用现代技术方案（前端使用 React/Vue，后端使用 Python FastAPI/Flask），并部署在 Render 平台，确保系统美观、易用且高效可靠。

如有任何疑问或需进一步讨论细节，请随时反馈。